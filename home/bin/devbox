#!/bin/bash
box=$1
shift
image=koelnconcert/devbox
hostname=${box}_docker

if [ -z "$box" ]; then 
        cat <<__EOF

    usage `basename $0` <name> [<options for docker>]

__EOF
    exit 1
fi


if docker inspect $box >/dev/null 2>&1; then # box exists
    is_running=`docker inspect --format {{.State.Running}} $box`
    if [ $is_running = "true" ]; then
        echo dev box $box is already running
        exit 1
    else
        echo "starting existing dev box $box"
        docker start -ai $@ $box
    fi
else
    echo creating new dev box "$box"
    docker run -it --name $box --hostname $hostname -v /var/run/docker.sock:/var/run/docker.sock $@ $image
fi
